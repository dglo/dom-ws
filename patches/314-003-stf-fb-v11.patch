? stf/src/all.src
? stf/src/appendsrc.sh
? stf/src/icecube.daq.stf.autogen.cf
? stf/src/icecube.daq.stf.autogen.deps
? stf/src/nlines.sh
Index: stf/private/stf-apps/flasher_brightness.c
===================================================================
RCS file: /home/icecube/cvsroot/stf/private/stf-apps/flasher_brightness.c,v
retrieving revision 1.4.2.2
diff -u -r1.4.2.2 flasher_brightness.c
--- stf/private/stf-apps/flasher_brightness.c	3 Feb 2005 23:37:05 -0000	1.4.2.2
+++ stf/private/stf-apps/flasher_brightness.c	15 Mar 2005 22:59:19 -0000
@@ -93,6 +93,7 @@
                                 char ** flasher_id,
                                 unsigned int * config_time_us,
                                 unsigned int * valid_time_us,
+                                unsigned int * reset_time_us,
                                 unsigned int * max_current_err_pct,
                                 unsigned int * worst_linearity_brightness,
                                 unsigned int * worst_linearity_led,
@@ -110,6 +111,10 @@
     /* Default return values */
     *worst_linearity_led = *worst_linearity_brightness = *max_current_err_pct = 0;
     *min_peak_brightness_atwd = *worst_brightness_led = 0;
+    *config_time_us = *reset_time_us = *valid_time_us = 0;
+
+    char dummy_id[9] = "deadbeef";
+    *flasher_id = dummy_id;
 
     /* Pedestal buffers -- only use channel 3 in this test */
     int *atwd_pedestal[4] = {NULL,
@@ -145,7 +150,7 @@
 
     /* Initialize the flaherboard and power up */
     /* Record configuration and clock validation times */
-    int err = hal_FB_enable(config_time_us, valid_time_us);
+    int err = hal_FB_enable(config_time_us, valid_time_us, reset_time_us);
     if (err != 0) {
 #ifdef VERBOSE
         printf("Flasher board enable failure (%d)!  Aborting test!\r\n", err);
Index: stf/private/stf-apps/flasher_brightness.xml
===================================================================
RCS file: /home/icecube/cvsroot/stf/private/stf-apps/flasher_brightness.xml,v
retrieving revision 1.2.2.1
diff -u -r1.2.2.1 flasher_brightness.xml
--- stf/private/stf-apps/flasher_brightness.xml	24 Nov 2004 19:47:40 -0000	1.2.2.1
+++ stf/private/stf-apps/flasher_brightness.xml	15 Mar 2005 22:59:19 -0000
@@ -4,7 +4,7 @@
   <name>flasher_brightness</name>
   <description>Flasher Board LED Brightness Test</description>
 
-  <version major="1" minor="2"/>
+  <version major="1" minor="3"/>
 
   <inputParameter>
     <description>DAC setting for ATWD sampling speed</description>
@@ -85,6 +85,12 @@
   </outputParameter>
 
   <outputParameter>
+    <description>Flasher Board Reset Time (us)</description>
+    <name>reset_time_us</name>
+    <unsignedInt/>
+  </outputParameter>
+
+  <outputParameter>
     <description>Max Percent Deviation of Amplitude from Linearity</description>
     <name>max_current_err_pct</name>
 	<unsignedInt/>
Index: stf/private/stf-apps/flasher_clock.c
===================================================================
RCS file: /home/icecube/cvsroot/stf/private/stf-apps/flasher_clock.c,v
retrieving revision 1.2.2.1
diff -u -r1.2.2.1 flasher_clock.c
--- stf/private/stf-apps/flasher_clock.c	4 Feb 2005 00:11:39 -0000	1.2.2.1
+++ stf/private/stf-apps/flasher_clock.c	15 Mar 2005 22:59:19 -0000
@@ -20,24 +20,27 @@
 
 /* Pass/fail defines */
 /* Maximum allowed clock validation time, in us */
-/* Should be around 2047-2048 us nominally*/
 /* Pass criterion is about 50us of instability */
-#define MAX_CLOCK_TIME_US  2100
+#define MAX_CLOCK_TIME_US  50
 
 BOOLEAN flasher_clockInit(STF_DESCRIPTOR *desc) { return TRUE; }
 
 BOOLEAN flasher_clockEntry(STF_DESCRIPTOR *desc,
                            char ** flasher_id,
                            unsigned int * config_time_us,
-                           unsigned int * valid_time_us
+                           unsigned int * valid_time_us,
+                           unsigned int * reset_time_us
                            ) {
-    
+
+    char dummy_id[9] = "deadbeef";
+    *flasher_id = dummy_id;
+
     /* Make sure PMT is off */
     halPowerDownBase();
 
     /* Initialize the flaherboard and power up */
     /* Record configuration and clock validation times */
-    int err = hal_FB_enable(config_time_us, valid_time_us);
+    int err = hal_FB_enable(config_time_us, valid_time_us, reset_time_us);
     if (err != 0) {
 #ifdef VERBOSE
         printf("Flasher board enable failure (%d)!  Aborting test!\r\n", err);
Index: stf/private/stf-apps/flasher_clock.xml
===================================================================
RCS file: /home/icecube/cvsroot/stf/private/stf-apps/flasher_clock.xml,v
retrieving revision 1.1.2.1
diff -u -r1.1.2.1 flasher_clock.xml
--- stf/private/stf-apps/flasher_clock.xml	4 Feb 2005 00:11:39 -0000	1.1.2.1
+++ stf/private/stf-apps/flasher_clock.xml	15 Mar 2005 22:59:19 -0000
@@ -4,7 +4,7 @@
   <name>flasher_clock</name>
   <description>Flasher Board LED Clock Stability Test</description>
 
-  <version major="1" minor="0"/>
+  <version major="1" minor="1"/>
 
   <outputParameter>
     <description>Flasher Board ID</description>
@@ -24,6 +24,12 @@
     <unsignedInt/>
   </outputParameter>
 
+  <outputParameter>
+    <description>Flasher Board Reset Time (us)</description>
+    <name>reset_time_us</name>
+    <unsignedInt/>
+  </outputParameter>
+
 </stf:test>
 
 
Index: stf/private/stf-apps/flasher_width.c
===================================================================
RCS file: /home/icecube/cvsroot/stf/private/stf-apps/flasher_width.c,v
retrieving revision 1.4.2.1
diff -u -r1.4.2.1 flasher_width.c
--- stf/private/stf-apps/flasher_width.c	24 Nov 2004 19:47:40 -0000	1.4.2.1
+++ stf/private/stf-apps/flasher_width.c	15 Mar 2005 22:59:19 -0000
@@ -55,6 +55,7 @@
                            char ** flasher_id,
                            unsigned int * config_time_us,
                            unsigned int * valid_time_us,
+                           unsigned int * reset_time_us,
                            unsigned int * missing_width,
                            unsigned int * failing_led,
                            unsigned int * led_avg_current
@@ -68,6 +69,10 @@
 
     /* Default return values */
     *failing_led = *missing_width = 0;
+    *config_time_us = *reset_time_us = *valid_time_us = 0;
+
+    char dummy_id[9] = "deadbeef";
+    *flasher_id = dummy_id;
 
     /* Pedestal buffers -- only use channel 3 in this test */
     int *atwd_pedestal[4] = {NULL,
@@ -99,7 +104,7 @@
 
     /* Initialize the flasherboard and power up */
     /* Record configuration and clock validation times */
-    int err = hal_FB_enable(config_time_us, valid_time_us);
+    int err = hal_FB_enable(config_time_us, valid_time_us, reset_time_us);
     if (err != 0) {
 #ifdef VERBOSE
         printf("Flasher board enable failure (%d)!  Aborting test!\r\n", err);
Index: stf/private/stf-apps/flasher_width.xml
===================================================================
RCS file: /home/icecube/cvsroot/stf/private/stf-apps/flasher_width.xml,v
retrieving revision 1.2.2.1
diff -u -r1.2.2.1 flasher_width.xml
--- stf/private/stf-apps/flasher_width.xml	24 Nov 2004 19:47:40 -0000	1.2.2.1
+++ stf/private/stf-apps/flasher_width.xml	15 Mar 2005 22:59:19 -0000
@@ -4,7 +4,7 @@
   <name>flasher_width</name>
   <description>Flasher Board LED Pulse Width Test</description>
 
-  <version major="1" minor="2"/>
+  <version major="1" minor="3"/>
 
   <inputParameter>
     <description>DAC setting for ATWD sampling speed</description>
@@ -85,6 +85,12 @@
   </outputParameter>
 
   <outputParameter>
+    <description>Flasher Board Reset Time (us)</description>
+    <name>reset_time_us</name>
+    <unsignedInt/>
+  </outputParameter>
+
+  <outputParameter>
     <description>Missing Pulse Width Coverage (ATWD units, ~ns)</description>
     <name>missing_width</name>
 	<unsignedInt/>
Index: stf/src/icecube/daq/stf/autogen/STFParameterLookup.java
===================================================================
RCS file: /home/icecube/cvsroot/stf/src/icecube/daq/stf/autogen/STFParameterLookup.java,v
retrieving revision 1.7.4.3
diff -u -r1.7.4.3 STFParameterLookup.java
--- stf/src/icecube/daq/stf/autogen/STFParameterLookup.java	4 Mar 2005 09:24:57 -0000	1.7.4.3
+++ stf/src/icecube/daq/stf/autogen/STFParameterLookup.java	15 Mar 2005 22:59:19 -0000
@@ -745,6 +745,9 @@
     hm.put("valid_time_us", p);
     p = new STFParameter( false );
     p.setType(STFParameterType.getType("unsignedInt"));
+    hm.put("reset_time_us", p);
+    p = new STFParameter( false );
+    p.setType(STFParameterType.getType("unsignedInt"));
     hm.put("max_current_err_pct", p);
     p = new STFParameter( false );
     p.setType(STFParameterType.getType("unsignedInt"));
@@ -834,6 +837,9 @@
     hm.put("valid_time_us", p);
     p = new STFParameter( false );
     p.setType(STFParameterType.getType("unsignedInt"));
+    hm.put("reset_time_us", p);
+    p = new STFParameter( false );
+    p.setType(STFParameterType.getType("unsignedInt"));
     hm.put("missing_width", p);
     p = new STFParameter( false );
     p.setType(STFParameterType.getType("unsignedInt"));
@@ -1404,6 +1410,9 @@
     p = new STFParameter( false );
     p.setType(STFParameterType.getType("unsignedInt"));
     hm.put("valid_time_us", p);
+    p = new STFParameter( false );
+    p.setType(STFParameterType.getType("unsignedInt"));
+    hm.put("reset_time_us", p);
 
     ret.put("atwd_led_nopmt", hm=new HashMap());
     p = new STFParameter( true );
